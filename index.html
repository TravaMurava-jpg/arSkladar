<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AR Scene with Guiding Arrow</title>
    <script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
</head>

<body style="margin: 0; overflow: hidden;">

    <a-scene embedded arjs>
        <!-- Arrow Model at the bottom of the screen -->
        <a-entity id="arrow" gltf-model="scene.gltf" position="0 -1 -4" rotation="0 0 0"></a-entity>
        <!-- Camera -->
        <a-entity camera></a-entity>
    </a-scene>

    <script>
        // Dummy data for testing
        const qrData = ["1,2,3", "4,5,6", "7,8,9"];

        let currentTargetIndex = 0;

        function rotateArrowToNextTarget() {
            // Get the next target coordinates from the QR data
            const targetCoordinates = qrData[currentTargetIndex].split(',').map(Number);

            // Calculate the rotation needed to point the arrow towards the target coordinates
            const rotation = calculateRotation(targetCoordinates);

            // Update the arrow's rotation
            document.getElementById('arrow').setAttribute('rotation', rotation);

            // Update the index for the next target
            currentTargetIndex = (currentTargetIndex + 1) % qrData.length;
        }

       function calculateRotation(targetCoordinates) {
    // Dummy values for the arrow's current position
    const arrowX = 0;
    const arrowY = 0;
    const arrowZ = 0;

    // Calculate the direction vector from the arrow to the target
    const directionX = targetCoordinates[0] - arrowX;
    const directionY = targetCoordinates[1] - arrowY;
    const directionZ = targetCoordinates[2] - arrowZ;

    // Calculate the rotation angles
    const rotationX = Math.atan2(directionZ, directionY) * (180 / Math.PI);
    const rotationY = Math.atan2(directionZ, directionX) * (180 / Math.PI);
    const rotationZ = Math.atan2(directionY, directionX) * (180 / Math.PI);

    return `${rotationX} ${rotationY} ${rotationZ}`;
}


        function update() {
            // Rotate the arrow to the next target
            rotateArrowToNextTarget();

            // Request the next animation frame
            requestAnimationFrame(update);
        }

        // Start the continuous updating
        update();
    </script>

</body>

</html>
