<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AR Scene with QR Markers</title>
    <script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>
    <!-- Importing AR.js with A-Frame support -->
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
</head>

<body style="margin: 0; overflow: hidden;">

    <a-scene embedded arjs>
        <!-- Markers and models will be dynamically added here -->
        <a-entity camera></a-entity>
    </a-scene>

    <script>
     // Get the URL parameters and read the QR codes data
const urlParams = new URLSearchParams(window.location.search);

if (!urlParams.has('qrCodes')) {
    console.log('No qrCodes parameter found in the URL!');
} else {
    const qrCodesData = JSON.parse(urlParams.get('qrCodes'));
    console.log('Parsed QR codes data:', qrCodesData);

    qrCodesData.forEach((data) => {
        console.log('Processing QR code:', data);
        
        // Create an a-marker for each QR code
        const marker = document.createElement('a-marker');
        marker.setAttribute('type', 'pattern');
        marker.setAttribute('url', data.patternURL);  // pointing to the .patt file

        // Add the arrow model for this QR code
        const arrowEntity = document.createElement('a-entity');
        arrowEntity.setAttribute('gltf-model', 'scene.gltf');
        
        // Set the rotation for the arrow based on the QR code data
        arrowEntity.setAttribute('rotation', `${data.x} ${data.y} ${data.z}`);
        
        console.log(`Setting rotation for QR code with pattern ${data.patternURL} to:`, arrowEntity.getAttribute('rotation'));

        marker.appendChild(arrowEntity);

        // Add the marker to the A-Frame scene
        document.querySelector('a-scene').appendChild(marker);
    });
}
    </script>

</body>

</html>
