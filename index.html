<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AR Scene with QR Markers</title>
    <script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>
    <!-- Importing AR.js with A-Frame support -->
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
</head>

<body style="margin: 0; overflow: hidden;">

    <a-scene embedded arjs>
        <!-- Markers and models will be dynamically added here -->
        <a-entity camera></a-entity>
    </a-scene>

    <script>
      // Get the URL parameters and read the barcode data
const urlParams = new URLSearchParams(window.location.search);

if (!urlParams.has('barcodes')) {
    console.log('No barcodes parameter found in the URL!');
} else {
    const barcodesData = JSON.parse(urlParams.get('barcodes'));
    console.log('Parsed barcodes data:', barcodesData);

    barcodesData.forEach((data) => {
        console.log('Processing barcode:', data);
        
        // Create an a-marker for each barcode
        const marker = document.createElement('a-marker');
        marker.setAttribute('type', 'barcode');
        marker.setAttribute('value', data.code);  // barcode number

        // Add the arrow model for this barcode
        const arrowEntity = document.createElement('a-entity');
        arrowEntity.setAttribute('gltf-model', 'scene.gltf');
        
        // Adjust position and scale here
        arrowEntity.setAttribute('position', '0 0 0');  // Adjust until model is centered on barcode
        arrowEntity.setAttribute('scale', '1 1 1');     // Adjust scale as needed

        // Set the rotation for the arrow based on the barcode data
        arrowEntity.setAttribute('rotation', `${data.x} ${data.y} ${data.z}`);
        
        console.log(`Setting rotation for barcode ${data.code} to:`, arrowEntity.getAttribute('rotation'));

        marker.appendChild(arrowEntity);

        // Add the marker to the A-Frame scene
        document.querySelector('a-scene').appendChild(marker);
    });
}
    </script>

</body>

</html>
